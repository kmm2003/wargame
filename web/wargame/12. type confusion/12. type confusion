힌트를 보니 간단한 비교문제라고 하면서 문제의 제목이 힌트라고 한다.

인터넷에 type confution 취약점을 검색해보니 객체의 인스턴스가 타입을 혼동하여 나는 오류라고한다.

이렇게만 봤을때는 솔직히 무슨말인지 잘 이해가 가지 않으니 문제를 살펴보자.

문제를 보니 한개의 폼과 소스가 주어져있다.

소스를 보니 

1. json이라는 데이터 값을 받고 있다.
2. 암호화한 값인 key 변수와 json의 키를 비교하고 있다. (json의 키란 json 객체의 key라는 키를 의미한다.)
3. 두 값이 같을 경우 flag가 주어진다.

즉, 입력하는 key값과 서버쪽에서 암호화한 key 변수값이 같으면 풀린다는 의미인데..

처음에는 sha1 암호화를 직접하여 같은 값을 찾아보려했으나 실패하였고 좀 더 찾아보던중
util.js라는 파일을 발견하였는데 여기서 입력한 key값을 객체의 json이라는 키의 값으로 서버에
전송하는 것을 확인 할 수 있었다.

type confution 취약점의 경우 객체의 인스턴스가 타입을 혼동하여 나는 오류라고 하였는데
아마 이런 특성을 생각해보았을 때 이 json 키가 들어있는 객체가 취약점의 핵심이 될 것 같다.

php == 의 느슨한 비교 취약점에 대해 조사를 해보았는데 일반 문자열과 true(bloon값) 라는 값이 비교되면 참으로 되는 것을 알 수 있게 되었고 혹시나 하여 크롬 개발자도구의 콘솔을 이용하여
소스를 객체안에 내가 입력한 키값이 아닌 true값으로 바꾸고 아무값이나 넣어 서버에 전송해보니...

문제가 해결됬다!!

클리어!! 


