힌트를 보니 blind sqli 문제로 ascii 와 date를 활용하게 될 것이라고 한다.

문제에 접속해보니 여러 사용자의 idx값과 ip주소가 테이블 형태로 나와있으며
아마 데이터베이스에 이런식으로 테이블이 저장되어있을 것이라 추측해 볼 수 있다.

상단에 admin login 이라는 문구를 누르면 로그인 창이 뜨는데 
여기서 admin으로 로그인을 하는 것이 이번 문제의 핵심요소인듯 하다.

admin login 창에서 여러 구문을 넣어보며 sql injection을 시도해보았지만
딱히 취약점이 보이지 않는다.

처음으로 돌아가 idx값과 ip주소가 테이블이 있는 화면에서 새로고침을 할때마다
특정 ip 주소가 계속 갱신되는 것을 확인 할 수 있고 그것은 나의 ip임을 알 수 있다.
즉, 새로운 접속자가 생길때마다 테이블이 갱신되는 것을 알 수 있다.

테이블을 직접눌러보니 접속한 시간이 기록되는 것을 확인 할 수 있고 
힌트에서 date를 활용하게 될 것이라고 하였음으로 여기서 취약점이 발견되지않을까?하는
의심을 해볼 수 있다.

버프스위트를 이용해 패킷을 잡아보니 idx값을 post 방식으로 넘기고 있으며 여기에 인젝션 값을 넣을 시 1970-01-01 09:00:00 과 같은 이상한 값이 출력되는 것을 확인 할 수 있었다.

즉, idx를 이용해 sql injection이 가능하다는 것을 알 수 있으며 인젝션을 시도해보자

대충 sql 쿼리를 예측해보면 다음과 같다.

select [time] from [table_name] where idx=${idx}

select [time] from [table_name] where idx=1 union select 30# 

위와 같은 예제 쿼리를 넘겨보니 시간 부분에 09:00:30 와 같이 초값이 30이 나온 것을 확인 할 수 있었고 이를 이용하여 아스키값을 받아 flag값을 구해 볼 수 있겠다.

먼저 테이블 갯수부터 구해보니 2개가 나왔고 이를 토대로 데이블명을 구하는 코드를 짜보니
(table_name.py)

admin_table이라는 테이블이 발견되었고 여기에 우리가 원하는 admin의 정보가 들어있을 것이다.

admin_table 테이블의 속성을 구해보자

속성을 구하려고 하니 값이 전혀 안나온다.....

오랜시간을 쏟았지만 이상하게 column의 총갯수가 6개인데 2개밖에 나오지않는?? 
버그같은 현상이 생겨서 한참을 고민하던중

admin 로그인 페이지에 로그인 폼의 이름이
id,ps인것을 보고 혹시? 하는 마음에 이것을 속성이라 생각하고 코드를 짜보았다.
(admin.py)

id와 pw가 정상적으로 출력되었다! 로그인해보자

클리어!!

속성명을 admin 페이지에서 유추해서 구해야된다는 점이 시간소요가 많이되는 문제였다...ㅠㅠ

