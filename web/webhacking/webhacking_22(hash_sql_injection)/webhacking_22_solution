https://www.md5online.org/md5-decrypt.html ==> md5 복호화 레인보우테이블 사이트

22번 문제는 대놓고 admin으로 로그인하라는 미션을 주었으며 속성값이 ip와 pw임을 알려주고있다.

21번 문제는 아무 힌트도 주지않았는데 22번은 이렇게 힌트를 많이주다니?? 갸꿀

우선 21번 방식과 똑같은 방식으로 두 가지의 로그인 결과 경우의 수를 구해보려하였으나
역시나 같은 방식으로는 blind sql injection이 불가능 한 것 같다.

여러가지 값을 집어넣으면서 특별한 결과가 나오는 경우가 있나했지만 없는 것 같다.

전 문제와 다른 점은 계정을 하나 만들수 있다는 것이다. guest / guest 라는 계정을 하나 만들어보겠다.

계정을 생성한 후 로그인을 해보았다.

로그인을 해보니 나의 패스워드 해쉬 값을 알려주었다. 이번문제는 패스워드 값이 해쉬로 저장되나보다.

서버쪽 코드를 한번 예측해보자!
select * from [table_name] where id=${id} and pw=${pw}
쿼리는 위와 같이 짜여있을 것이며 여기서 핵심은 쿼리값에 들어가는 pw가 해쉬값으로 변환되어 들어가냐이다. 변환되어 들어간다면 이전 문제와는 전혀 다른 문제가 될 것이며 변환이 되지 않는다면
이전 문제와 비슷한 양상을 띌 것이다.

즉, 
1. 변환되어 hash값이 쿼리에 들어가는 경우
2. 그렇지 않은 경우(단순 blind sql injection 문제)

위 두 가지 경우를 모두 생각해보아야 한다.

우선 2번의 경우로 문제를 한번 풀어보자 
guest / 1'or(id='guest')and((length(pw))>0)#

위의 값들을 집어넣었지만 login fail!이 뜬다 아마도 1번의 경우의 문제가 맞는 것 같다.
혹시몰라 if(1,guest,guest)를 패스워드로도 집어넣어보았지만
결과는 똑같다. 1번 예시처럼 hash로 변환후 쿼리에 집어넣는 것이 맞는 것 같다.

guest로 로그인했을때의 해쉬값이 어떤 암호화로 이루어졌는지 표준적인 것들을 모두 확인해보았다.
(md5,sha1,sha256,sha512)
......모두 안맞는다....싀발...

그렇다는 것은
1. 여러번 해시 암호화가 이루어졌다.
2. 다른 문자와 더해지고 나서 암호화가 이루어졌다.

이 두 가지 경우중 한가지라는 것이고 2번째의 경우라면 문제를 풀 수 없기 때문에
1번일 가능성이 높아보인다....
1번이면 레인보우테이블을 만들어서 값을 구해야 하는데...허허 거지같은 문제다.

1'or(id='guest')and((length(pw))>0)#

레인보우테이블을 만들생각에 기분이 매우 안좋던 이때!!

갑자기 좋은 생각이 떠올랐다. 바로 2번의 경우에서 pw가 해시 암호화가 이루어져 pw값으로 전송되는게 맞으니 당연히 sql인젝션이 안통한다. 따라서 1번의 방법을 써야한다고 생각했지만 

id값은 해시가 안되지 않겠는가?? 그러면 인젝션도 당연히 통한다. 한번 시도해보겠다.

1'or(id='guest')and((length(pw))>0)# / guest

위와같이 입력하여 로그인해보았다.

위와 같이 로그인하였더니 guest계정으로 정상적으로 접속되었다!!
근데 이때 문제가 발생했다....바로 비밀번호가 guest가 아니면 접속이 안되고 wrong password라고 나온다....

여기서 아마도 #이 필터링 되는 것 같든데... 버프스위트를 통해 확인해보려하는차에 또다른 생각이 났다.

바로 21번문제이다. 21번문제도 결국 똑같은 방식으로 wrong password일때와 login fail이 뜰떄 두가지로 나누어서 blind sql injection을 통해 값을 구하였다. 똑같은 방식으로 인젝션을 진행하면 될 것 같다.

1'or(id='admin')and((length(pw))={i})# / 1 ==> admin length

위와 같은 쿼리를 이용하여 post 방식으로 전송하여 값을 알아보겠다.

admin의 패스워드길이는 32자리로 나왔다. 
32자리??? md5해싱하면 32자리가 나오는데 아마도 md5해싱한 값의 자릿수가 나왔나보다.

즉, 이 문제는 해쉬값을 구하여 레인보우테이블을 이용해 평문값을 추출해내는 문제인 것 같다..
결국 레인보우테이블이라니...ㅠ

1'or(id='admin')and((ascii(substr(pw,{i},1))like({j})))#

위 쿼리문을 넣어 pw를 구해보겠다.

pw값은 6c9ca386a903921d7fa230ffa0ffc153으로 나왔다. md5해시된 값이다. 
이것을 레인보우테이블을 이용하여 구해야하나 그러기는 너무 싫어서 인터넷을 통해 레인보우테이블이 저장된 사이트들을 이용하여 여러사이트를 거쳐 복호화를 해보았다.

결국 https://www.md5online.org/md5-decrypt.html

위 사이트를 통해 복호화에 성공했다 wowapple이라는 결과가 나왔다

로그인을 해보겠다!!

로그인 실패다....????????? 흠 뭔가 이상하여 guest 계정의 패스워드 해시값을 복호화 해보았다.

guest라고 나와야 되는데 guestapple이라고 나온다!! 그렇다....

단순히 해싱만 하는 것이 아니라 평문 pw에 apple을 붙여서 해싱하는 것이였다.....

아까 복호화한 값이 wowapple이였음으로 답은 wow일 것이다. 로그인 해보자

클리어!!






