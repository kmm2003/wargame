로그 인젝션이라는 타이틀과 함께 로그인이라는 폼이 하나 존재하는 것을 확인할 수 있다.

개발자도구로 소스를 봐보니 admin.php라는 파일이 존재한다 한번 들어가보겠다.

들어가보니 admin처럼 기록을 해야된다??라는 문구와 함께 정체불명의 로그가 써있다. 

다시전으로 돌아가 아무값이나 입력해보겠다.

아무값이나 입력한 후에 admin.php로 들어와보니 역시나 입력값이 기록되어있다.
입력값을 토대로 저장된 기록의 형태를 파악해보니 
ip : 입력값 의 형태임을 파악할 수 있다.

이번 문제의 목표는 admin : 입력값의 형태로 기록을 하는 것이 목표이다. 
그러나 우리가 입력할 수 있는 폼에는 입력값만을 조작할 수 있고 : 앞에는 자동으로 ip값이 들어간다.

단순히 생각해보면 admin : 입력값 이라는 형태의 기록을 남기는 것이 목표이기 때문에 
textarea 취약점을 이용하여 input폼을 textarea로 변경하여 
ip : 입력값(문자 \n admin : 문자) 의 형태로 기록을 남기면 두줄로 기록을 생성하게 되고 
따라서 admin이 남긴 기록처럼 조작이 가능 할 것이다.

1. 먼저 input태그를 textarea태그로 변경
2. textarea 폼에 hi \n admin : hi 를 입력하여 기록저장
3. admin.php 로그 확인!

위의 과정을 모두 해보았더니...? 아무 변화가 없다??? 기록을 보면 admin:hi 라는 기록이 정상적으로 남아있다....흠....

생각을 해보니 맨처음 log injection 폼에서 버튼 이름이 login이고 기록에도 guest라는 값이 남아있는 것을 보아 설마 admin으로 로그인한다는 의미가 입력값이 admin인 것을 의미하나? 하고 폼에 admin을 입력해보니 나는 admin이 아니라고 경고 문구가 뜬다!! (문제를 잘 못 이해했었다.)

1. 먼저 input태그를 textarea태그로 변경
2. textarea 폼에 hi \n [ip주소]:admin 을 입력하여 기록저장
3. admin.php 로그 확인!

과정을 좀 수정하여 위와 같이 수행해보았다.

클리어!!

