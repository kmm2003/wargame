파일을 업로드 할 수 있게 되어있으며 tmp라는 몇개의 파일은 이미 업로드 된 것으로 예상된다.

소스코드를 살펴보자

select flag from challenge where idx=37
위 쿼리를 통해 idx=37인 레코드의 flag값을 select하며 $flag에 flag값을 저장한다.
$time에 시간을 저장후 ./tmp/tmp-{$time} 이라는 파일을 오픈하여 127.0.0.1이라는 값을 쓴 후 닫는다.

파일을 업로드 할 경우 파일이름을 $file_nm에 저장하며 5번의 치환과정을 거친다.

치환과정을 거친 $file_nm의 값이 존재하면 ./tmp/{$file_nm} 이라는 파일을 열어 
클라이언트의 ip값을 저장한다.

그 후 코드는 /tmp 디렉토리의 파일을 스캔하여 브라우저에 모두 표시하는 것과 20개가 넘는경우 파일을 모두 삭제하는 코드가 있으며 

그사이에 코드를 보면 여기가 핵심인 것 같은데 
$host에 tmp-{$time} 파일의 내용을 문자열로 저장하며 
$request라는 변수에 get방식의 request패킷 구문을 넣는데 url부분에 $flag를 host부분에 $host를 넣어 패킷을 만든후 7777포트로 소캣을 열어 파일을 전송한다.

포트포워딩이을 통해 7777번 포트로 패킷을 받을 수 있게 준비한후 7777번 포트를 열어 대기한 상태에서 패킷을 받을 서버의 ip를 내용으로 넣은 파일을 업로드하는데 이때 업로드할때의 패킷을 잡아서 파일명을 조작하여야 하는 문제이다. 여기서는 실행할 수 없기 때문에 패스~!

